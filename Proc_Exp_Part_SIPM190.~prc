CREATE OR REPLACE PROCEDURE Proc_Exp_Part(blanks nvarchar2, v_rootid nvarchar2, v_objtype nvarchar2, v_interfacelist nvarchar2, v_syncbatchno nvarchar2, v_accid nvarchar2, v_username nvarchar2)
AS
    v_SQL_Text varchar(8000);
    v_MidTableList varchar(4000);
    v_partbatchno varchar(50);  -- 物料批次号

    v_ErrRowCount number(9);
    v_ErrRaise EXCEPTION;
    v_ErrCode varchar2(20);
    v_ErrMsg varchar2(2000);
BEGIN
    -- 三个接口共用一个批次号的sipmt_bomtree,在传输完成后主动删除sipmt_bomtree中该批次号数据
    --v_include_CL    是否输出材料定额  0 - 不需要/1 - 需要
    --v_include_GXZJ  是否输出工序子件  0 - 不需要/1 - 需要,       怎么理解一个零部件既有BOM子件,又有工序子件???????
    --v_include_FL    是否输出辅料      0 - 不需要/1 - 需要
    v_partbatchno := 'P'||v_syncbatchno;
    -- DBMS_OUTPUT.put_line(v_partbatchno);
    UPDATE SIPM195 SET ENAME='PART' WHERE NO=v_syncbatchno;   -- 标记数据包类型
    -- 取工作区数据
    INSERT INTO sipm190 (id,publishtn,publishid,stn,sid,syncbatchno,syncdataitemno,syncuser
        ,MTART,EXTWG,MATKL,GROES,SPART,OLDNO,NO,MAKTX,TDLINE,ZIND,UNIT,ZVARIANT,ZMAKTX,ZSIZE,ZTYPE,ZCOLOR,ZBRANCH,ZAUTH,ZROHS,ZPACKAGE,ZPAPER,ZVERSION,ZMANUAL,MSTAE,MTPOS,WERKS
        ,CLASSNUM,CLASSTYPE,NUMERATOR,DENOMINATR,BSTME,XCHPF,KORDB,EKGRP,ZTDLINE1
        ,VKORG,VTWEG,KTGRM,ALAND,TATYP,TAXKM,MTPOS1,TRAGR,LADGR,ZTDLINE2
        ,DISMM,DISPO,DISLS,BSTRF,BSTMI,BERID,DISPR
        ,BESKZ,SOBSL,RGEKM,LGFSB,LGPRO,DZEIT,PLIFZ,WEBAZ,FHORI,EISBE,PERKZ,STRGR,VRMOD,VINT1,VINT2,MISKZ,MTVFP,KZAUS,NFMAT,SBDKZ
        ,FEVOR,CO_PRODPRF
        ,MHDRZ,MHDHB,LOGGR,LGNUM,LTKZE
        ,QMATV,QPART,QMATA,SSQSS,ZTDLINE3,PRFRQ
        ,BKLAS,EKLAS,QKLAS,MLAST,PEINH,VPRSV,LOSGR,AWSLS,HRKFT,PRCTR,EKALR,HKMAT,SOBSK,ZPLP3,ZPLD3
        ,ZTIME1--,ZDATE,ZTIME2,ZMSGTP2,ZMESTX
        ,AUSCH
        )
    SELECT 'O1_'||SYS_GUID(),'PBOMPKG',v_rootid,'SIPM190',t1.id,v_partbatchno,t1.NO,v_username,
        TB.MTART,TB.EXTWG,TB.MATKL,TB.GROES,TB.SPART,TB.OLDNO AS ZBISMT,TB.NO AS MATNR,TB.MAKTX,TB.TDLINE,TB.ZIND,TB.UNIT AS MEINS,TB.ZVARIANT,TB.ZMAKTX,TB.ZSIZE,TB.ZTYPE,TB.ZCOLOR,TB.ZBRANCH,TB.ZAUTH,TB.ZROHS,TB.ZPACKAGE,TB.ZPAPER,TB.ZVERSION,TB.ZMANUAL,TB.MSTAE,TB.MTPOS,TB.WERKS,
        T1.CLASSNUM,T1.CLASSTYPE,T1.NUMERATOR,T1.DENOMINATR,T1.BSTME,T1.XCHPF,T1.KORDB,T1.EKGRP,TB.TDLINE,
        T2.VKORG,T2.VTWEG,T2.KTGRM,T2.ALAND,T2.TATYP,T2.TAXKM,T2.MTPOS1,T2.TRAGR,T2.LADGR,TB.TDLINE,
        T3.DISMM,T3.DISPO,T3.DISLS,T3.BSTRF,T3.BSTMI,T3.BERID,T3.DISPR,
        T4.BESKZ,T4.SOBSL,T4.RGEKM,T4.LGFSB,T4.LGPRO,T4.DZEIT,T4.PLIFZ,T4.WEBAZ,T4.FHORI,T4.EISBE,T4.PERKZ,T4.STRGR,T4.VRMOD,T4.VINT1,T4.VINT2,T4.MISKZ,T4.MTVFP,T4.KZAUS,T4.NFMAT,T4.SBDKZ,
        T5.FEVOR,T5.CO_PRODPRF,
        T6.MHDRZ,T6.MHDHB,T6.LOGGR,T6.LGNUM,T6.LTKZE,
        T7.QMATV,T7.QPART,T7.QMATA,T7.SSQSS,T7.ZTDLINE3,T7.PRFRQ,
        T8.BKLAS,T8.EKLAS,T8.QKLAS,T8.MLAST,T8.PEINH,T8.VPRSV,T8.LOSGR,T8.AWSLS,T8.HRKFT,T8.PRCTR,T8.EKALR,T8.HKMAT,T8.SOBSK,ROUND(T8.ZPLP3*T8.PEINH,6),T8.ZPLD3,
        v_syncbatchno,
        TB.AUSCH
    FROM WK_PARTLIB TB
    -- INNER JOIN SAPI_NEWNO ON TB.NO = SAPI_NEWNO.NEWNO
    LEFT JOIN WK_SIPM91_OBJOF T1O ON TB.ID = T1O.ITEMID1 AND T1O.DEL=0 AND T1O.WKAID<>'3'
    LEFT JOIN WK_SIPM91 T1 ON T1O.ITEMID2 = T1.ID AND T1.DEL=0 AND T1.WKAID<>'3'
    LEFT JOIN WK_SIPM92_OBJOF T2O ON TB.ID = T2O.ITEMID1 AND T2O.DEL=0 AND T2O.WKAID<>'3'
    LEFT JOIN WK_SIPM92 T2 ON T2O.ITEMID2 = T2.ID AND T2.DEL=0 AND T2.WKAID<>'3'
    LEFT JOIN WK_SIPM93_OBJOF T3O ON TB.ID = T3O.ITEMID1 AND T3O.DEL=0 AND T3O.WKAID<>'3'
    LEFT JOIN WK_SIPM93 T3 ON T3O.ITEMID2 = T3.ID AND T3.DEL=0 AND T3.WKAID<>'3'
    LEFT JOIN WK_SIPM94_OBJOF T4O ON TB.ID = T4O.ITEMID1 AND T4O.DEL=0 AND T4O.WKAID<>'3'
    LEFT JOIN WK_SIPM94 T4 ON T4O.ITEMID2 = T4.ID AND T4.DEL=0 AND T4.WKAID<>'3'
    LEFT JOIN WK_SIPM95_OBJOF T5O ON TB.ID = T5O.ITEMID1 AND T5O.DEL=0 AND T5O.WKAID<>'3'
    LEFT JOIN WK_SIPM95 T5 ON T5O.ITEMID2 = T5.ID AND T5.DEL=0 AND T5.WKAID<>'3'
    LEFT JOIN WK_SIPM96_OBJOF T6O ON TB.ID = T6O.ITEMID1 AND T6O.DEL=0 AND T6O.WKAID<>'3'
    LEFT JOIN WK_SIPM96 T6 ON T6O.ITEMID2 = T6.ID AND T6.DEL=0 AND T6.WKAID<>'3'
    LEFT JOIN WK_SIPM97_OBJOF T7O ON TB.ID = T7O.ITEMID1 AND T7O.DEL=0 AND T7O.WKAID<>'3'
    LEFT JOIN WK_SIPM97 T7 ON T7O.ITEMID2 = T7.ID AND T7.DEL=0 AND T7.WKAID<>'3'
    LEFT JOIN WK_SIPM98_OBJOF T8O ON TB.ID = T8O.ITEMID1 AND T8O.DEL=0 AND T8O.WKAID<>'3'
    LEFT JOIN WK_SIPM98 T8 ON T8O.ITEMID2 = T8.ID AND T8.DEL=0 AND T8.WKAID<>'3'
    WHERE TB.DEL=0 AND TB.WKAID<>'3'
        AND TB.PBOMPKGID = v_rootid
        AND TB.NO IS NOT NULL;

    -- 取归档区数据
    INSERT INTO sipm190 (id,publishtn,publishid,stn,sid,syncbatchno,syncdataitemno,syncuser
        ,MTART,EXTWG,MATKL,GROES,SPART,OLDNO,NO,MAKTX,TDLINE,ZIND,UNIT,ZVARIANT,ZMAKTX,ZSIZE,ZTYPE,ZCOLOR,ZBRANCH,ZAUTH,ZROHS,ZPACKAGE,ZPAPER,ZVERSION,ZMANUAL,MSTAE,MTPOS,WERKS
        ,CLASSNUM,CLASSTYPE,NUMERATOR,DENOMINATR,BSTME,XCHPF,KORDB,EKGRP,ZTDLINE1
        ,VKORG,VTWEG,KTGRM,ALAND,TATYP,TAXKM,MTPOS1,TRAGR,LADGR,ZTDLINE2
        ,DISMM,DISPO,DISLS,BSTRF,BSTMI,BERID,DISPR
        ,BESKZ,SOBSL,RGEKM,LGFSB,LGPRO,DZEIT,PLIFZ,WEBAZ,FHORI,EISBE,PERKZ,STRGR,VRMOD,VINT1,VINT2,MISKZ,MTVFP,KZAUS,NFMAT,SBDKZ
        ,FEVOR,CO_PRODPRF
        ,MHDRZ,MHDHB,LOGGR,LGNUM,LTKZE
        ,QMATV,QPART,QMATA,SSQSS,ZTDLINE3,PRFRQ
        ,BKLAS,EKLAS,QKLAS,MLAST,PEINH,VPRSV,LOSGR,AWSLS,HRKFT,PRCTR,EKALR,HKMAT,SOBSK,ZPLP3,ZPLD3
        ,ZTIME1--,ZDATE,ZTIME2,ZMSGTP2,ZMESTX
        ,AUSCH
        )
    SELECT 'O1_'||SYS_GUID(),'PBOMPKG',v_rootid,'SIPM190',t1.id,v_partbatchno,t1.NO,v_username,
        TB.MTART,TB.EXTWG,TB.MATKL,TB.GROES,TB.SPART,TB.OLDNO AS ZBISMT,TB.NO AS MATNR,TB.MAKTX,TB.TDLINE,TB.ZIND,TB.UNIT AS MEINS,TB.ZVARIANT,TB.ZMAKTX,TB.ZSIZE,TB.ZTYPE,TB.ZCOLOR,TB.ZBRANCH,TB.ZAUTH,TB.ZROHS,TB.ZPACKAGE,TB.ZPAPER,TB.ZVERSION,TB.ZMANUAL,TB.MSTAE,TB.MTPOS,TB.WERKS,
        T1.CLASSNUM,T1.CLASSTYPE,T1.NUMERATOR,T1.DENOMINATR,T1.BSTME,T1.XCHPF,T1.KORDB,T1.EKGRP,TB.TDLINE,
        T2.VKORG,T2.VTWEG,T2.KTGRM,T2.ALAND,T2.TATYP,T2.TAXKM,T2.MTPOS1,T2.TRAGR,T2.LADGR,TB.TDLINE,
        T3.DISMM,T3.DISPO,T3.DISLS,T3.BSTRF,T3.BSTMI,T3.BERID,T3.DISPR,
        T4.BESKZ,T4.SOBSL,T4.RGEKM,T4.LGFSB,T4.LGPRO,T4.DZEIT,T4.PLIFZ,T4.WEBAZ,T4.FHORI,T4.EISBE,T4.PERKZ,T4.STRGR,T4.VRMOD,T4.VINT1,T4.VINT2,T4.MISKZ,T4.MTVFP,T4.KZAUS,T4.NFMAT,T4.SBDKZ,
        T5.FEVOR,T5.CO_PRODPRF,
        T6.MHDRZ,T6.MHDHB,T6.LOGGR,T6.LGNUM,T6.LTKZE,
        T7.QMATV,T7.QPART,T7.QMATA,T7.SSQSS,T7.ZTDLINE3,T7.PRFRQ,
        T8.BKLAS,T8.EKLAS,T8.QKLAS,T8.MLAST,T8.PEINH,T8.VPRSV,T8.LOSGR,T8.AWSLS,T8.HRKFT,T8.PRCTR,T8.EKALR,T8.HKMAT,T8.SOBSK,ROUND(T8.ZPLP3*T8.PEINH,6),T8.ZPLD3,
        v_syncbatchno,
        TB.AUSCH
    FROM PARTLIB TB
    -- INNER JOIN SAPI_NEWNO ON TB.NO = SAPI_NEWNO.NEWNO
    LEFT JOIN SIPM91_OBJOF T1O ON TB.ID = T1O.ITEMID1 AND T1O.DEL=0 AND T1O.WKAID<>'3'
    LEFT JOIN SIPM91 T1 ON T1O.ITEMID2 = T1.ID AND T1.DEL=0 AND T1.WKAID<>'3'
    LEFT JOIN SIPM92_OBJOF T2O ON TB.ID = T2O.ITEMID1 AND T2O.DEL=0 AND T2O.WKAID<>'3'
    LEFT JOIN SIPM92 T2 ON T2O.ITEMID2 = T2.ID AND T2.DEL=0 AND T2.WKAID<>'3'
    LEFT JOIN SIPM93_OBJOF T3O ON TB.ID = T3O.ITEMID1 AND T3O.DEL=0 AND T3O.WKAID<>'3'
    LEFT JOIN SIPM93 T3 ON T3O.ITEMID2 = T3.ID AND T3.DEL=0 AND T3.WKAID<>'3'
    LEFT JOIN SIPM94_OBJOF T4O ON TB.ID = T4O.ITEMID1 AND T4O.DEL=0 AND T4O.WKAID<>'3'
    LEFT JOIN SIPM94 T4 ON T4O.ITEMID2 = T4.ID AND T4.DEL=0 AND T4.WKAID<>'3'
    LEFT JOIN SIPM95_OBJOF T5O ON TB.ID = T5O.ITEMID1 AND T5O.DEL=0 AND T5O.WKAID<>'3'
    LEFT JOIN SIPM95 T5 ON T5O.ITEMID2 = T5.ID AND T5.DEL=0 AND T5.WKAID<>'3'
    LEFT JOIN SIPM96_OBJOF T6O ON TB.ID = T6O.ITEMID1 AND T6O.DEL=0 AND T6O.WKAID<>'3'
    LEFT JOIN SIPM96 T6 ON T6O.ITEMID2 = T6.ID AND T6.DEL=0 AND T6.WKAID<>'3'
    LEFT JOIN SIPM97_OBJOF T7O ON TB.ID = T7O.ITEMID1 AND T7O.DEL=0 AND T7O.WKAID<>'3'
    LEFT JOIN SIPM97 T7 ON T7O.ITEMID2 = T7.ID AND T7.DEL=0 AND T7.WKAID<>'3'
    LEFT JOIN SIPM98_OBJOF T8O ON TB.ID = T8O.ITEMID1 AND T8O.DEL=0 AND T8O.WKAID<>'3'
    LEFT JOIN SIPM98 T8 ON T8O.ITEMID2 = T8.ID AND T8.DEL=0 AND T8.WKAID<>'3'
    WHERE TB.DEL=0 AND TB.WKAID<>'3'
        AND TB.PBOMPKGID = v_rootid
        AND TB.NO IS NOT NULL;
        
        -------------------插入1806，1906扩展的数据
         INSERT INTO sipm190 (id,publishtn,publishid,stn,sid,syncbatchno,syncdataitemno,syncuser
        ,MTART,EXTWG,MATKL,GROES,SPART,OLDNO,NO,MAKTX,TDLINE,ZIND,UNIT,ZVARIANT,ZMAKTX,ZSIZE,ZTYPE,ZCOLOR,ZBRANCH,ZAUTH,ZROHS,ZPACKAGE,ZPAPER,ZVERSION,ZMANUAL,MSTAE,MTPOS,WERKS
        ,CLASSNUM,CLASSTYPE,NUMERATOR,DENOMINATR,BSTME,XCHPF,KORDB,EKGRP,ZTDLINE1
        ,VKORG,VTWEG,KTGRM,ALAND,TATYP,TAXKM,MTPOS1,TRAGR,LADGR,ZTDLINE2
        ,DISMM,DISPO,DISLS,BSTRF,BSTMI,BERID,DISPR
        ,BESKZ,SOBSL,RGEKM,LGFSB,LGPRO,DZEIT,PLIFZ,WEBAZ,FHORI,EISBE,PERKZ,STRGR,VRMOD,VINT1,VINT2,MISKZ,MTVFP,KZAUS,NFMAT,SBDKZ
        ,FEVOR,CO_PRODPRF
        ,MHDRZ,MHDHB,LOGGR,LGNUM,LTKZE
        ,QMATV,QPART,QMATA,SSQSS,ZTDLINE3,PRFRQ
        ,BKLAS,EKLAS,QKLAS,MLAST,PEINH,VPRSV,LOSGR,AWSLS,HRKFT,PRCTR,EKALR,HKMAT,SOBSK,ZPLP3,ZPLD3
        ,ZTIME1--,ZDATE,ZTIME2,ZMSGTP2,ZMESTX
        ,AUSCH,ordernum
        )
    SELECT '01_'||SYS_GUID(),'PBOMPKG',v_rootid,'SIPM190',t1.id,v_partbatchno,t1.NO,v_username,
        MTART,EXTWG,MATKL,GROES,SPART,OLDNO,NO,MAKTX,TDLINE,ZIND,UNIT,ZVARIANT,ZMAKTX,ZSIZE,ZTYPE,ZCOLOR,ZBRANCH,ZAUTH,ZROHS,
        ZPACKAGE,ZPAPER,ZVERSION,ZMANUAL,MSTAE,MTPOS,WERKS
        ,CLASSNUM,CLASSTYPE,NUMERATOR,DENOMINATR,BSTME,XCHPF,KORDB,EKGRP,ZTDLINE1
        ,VKORG,VTWEG,KTGRM,ALAND,TATYP,TAXKM,MTPOS1,TRAGR,LADGR,ZTDLINE2
        ,DISMM,DISPO,DISLS,BSTRF,BSTMI,BERID,DISPR
        ,BESKZ,SOBSL,RGEKM,LGFSB,LGPRO,DZEIT,PLIFZ,WEBAZ,FHORI,EISBE,PERKZ,STRGR,VRMOD,VINT1,VINT2,MISKZ,MTVFP,KZAUS,NFMAT,SBDKZ
        ,FEVOR,CO_PRODPRF
        ,MHDRZ,MHDHB,LOGGR,LGNUM,LTKZE
        ,QMATV,QPART,QMATA,SSQSS,ZTDLINE3,PRFRQ
        ,BKLAS,EKLAS,QKLAS,MLAST,PEINH,VPRSV,LOSGR,AWSLS,HRKFT,PRCTR,EKALR,HKMAT,SOBSK,ZPLP3,ZPLD3
        --,v_syncbatchno
        ,AUSCH,ordernum
    FROM SIPM170 TB
        --------------------

    if v_interfacelist = 'PART' THEN
        -- 创建物料传输数据临时表
        v_SQL_Text := ' CREATE TABLE ' || ' GT_IMPORT_' || v_syncbatchno
            || ' AS '
            || ' SELECT ID,SYNCBATCHNO,SYNCDATAITEMNO,ID AS SIPMID,SYNCBATCHNO AS ZTIME1 '
            || '     ,NO AS MATNR,MTART,EXTWG,MATKL,GROES,SPART,OLDNO AS ZBISMT,MAKTX,TDLINE,ZIND,UNIT AS MEINS,ZVARIANT,ZMAKTX,ZSIZE,ZTYPE,ZCOLOR,ZBRANCH,ZAUTH,ZROHS,ZPACKAGE,ZPAPER,ZVERSION,ZMANUAL,MSTAE,MTPOS,WERKS,CLASSNUM,CLASSTYPE,NUMERATOR,DENOMINATR,BSTME,XCHPF,KORDB,EKGRP,ZTDLINE1,VKORG,VTWEG,KTGRM,ALAND,TATYP,TAXKM,MTPOS1,TRAGR,LADGR,ZTDLINE2,DISMM,DISPO,DISLS,BSTRF,BSTMI,BERID,DISPR,BESKZ,SOBSL,RGEKM,LGFSB,LGPRO,DZEIT,PLIFZ,WEBAZ,FHORI,EISBE,PERKZ,STRGR,VRMOD,VINT1,VINT2,MISKZ,MTVFP,KZAUS,NFMAT,SBDKZ,FEVOR,CO_PRODPRF,MHDRZ,MHDHB,LOGGR,LGNUM,LTKZE,QMATV,QPART,QMATA,SSQSS,ZTDLINE3,PRFRQ,BKLAS,EKLAS,QKLAS,MLAST,PEINH,VPRSV,LOSGR,AWSLS,HRKFT,PRCTR,EKALR,HKMAT,SOBSK,ZPLP3,ZPLD3,AUSCH AS KAUSF'
            || ' FROM sipm190 '
            || ' WHERE SyncBatchNo=''' || v_partbatchno || '''';
        dbms_output.put_line(v_SQL_Text);

        EXECUTE IMMEDIATE v_SQL_Text;
        v_MidTableList := 'GT_IMPORT_' || v_syncbatchno;
    END IF;
/*
    insert into sipm196 (id,no,syncdataitemno,syncmsg )
    select '01_'||SYS_GUID(),t.syncbatchno,t.syncdataitemno,'运算错误提示。数据项:' || t.syncdataitemno ||'的/制造方式/空！'
    from sipm190 t
    where t.syncbatchno=v_partbatchno and t.SOURCE is null;

    insert into sipm196 (id,no,syncdataitemno,syncmsg )
    select '01_'||SYS_GUID(),t.syncbatchno,t.syncdataitemno,'运算错误提示。数据项:' || t.syncdataitemno ||'的/固定损耗率/非数值！'
    from sipm190 t
    where t.syncbatchno=v_partbatchno and not regexp_like(t.RATE, '^{0,9}[[:digit:]]{0,1}[\.]{0,6}[[:digit:]]$');
*/
    -- 写数据准备结果
    select count(*) into v_ErrRowCount From sipm196 t where t.no=v_partbatchno;
    if v_ErrRowCount>0 then
        v_SQL_Text :=' INSERT INTO ' || BLANKS || ' (fresult, frows, fmsg, fmidtablelist) values(''Failure'', 0, ''物料数据准备失败。'', '''')';
    else
        v_SQL_Text :=' INSERT INTO ' || BLANKS || ' (fresult, frows,fmsg,fmidtablelist) select ''Success'' as fresult, count(*) as frows, ''物料数据准备完成。共：'' || to_char(count(*)) || ''行。'' AS fmsg, '''|| v_MidTableList || ''' AS fmidtablelist FROM sipm190 WHERE SyncBatchNo = ''' || v_partbatchno || '''';
    end if;
    EXECUTE immediate v_SQL_Text;
    COMMIT;

    -- RAISE v_ErrRaise;

EXCEPTION
    when v_ErrRaise then
        v_ErrCode := to_char(SQLCODE);
        v_ErrMsg := SUBSTR(SQLERRM, 1, 200);
        rollback;
        insert into sipm196 (id,no,syncmsg,pbompkgid )
        values ('01_'||SYS_GUID(),v_partbatchno,'运算错误提示。物料导出数据准备异常。错误代码：' || v_ErrCode || '；错误消息：' || v_ErrMsg || '。',v_rootid);
        v_SQL_Text :=' INSERT INTO ' || BLANKS || ' (fresult, frows, fmsg, fmidtablelist) values(''Failure'', 0, ''物料导出数据准备失败。'', '''')';
        execute immediate v_SQL_Text;
        commit;
    when others then
        v_ErrCode := SQLCODE;
        v_ErrMsg := SUBSTR(SQLERRM, 1, 200);
        rollback;
        insert into sipm196 (id,no,syncmsg,pbompkgid )
        values ('01_'||SYS_GUID(),v_partbatchno,'运算错误提示。物料导出数据准备异常。错误代码：' || v_ErrCode || '；错误消息：' || v_ErrMsg || '。',v_rootid);
        v_SQL_Text :=' INSERT INTO ' || BLANKS || ' (fresult, frows, fmsg, fmidtablelist) values(''Failure'', 0, ''物料导出数据准备失败。'', '''')';
        execute immediate v_SQL_Text;
        commit;
END ;


 

 

 
/
